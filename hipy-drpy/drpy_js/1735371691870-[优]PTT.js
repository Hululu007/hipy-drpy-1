var rule = {
    类型: '影视',//影视|听书|漫画|小说
    title: '[优]PTT',
    host: 'https://ptt.red',
    homeUrl: '/zh-cn',
    url: '/zh-cn/p/fyclassfyfilter',
    searchUrl: '/zh-cn/q/**?page=fypage',
    searchable: 2,
    quickSearch: 0,
    filterable: 1,
    filter:{"1":[{"key":"地区","name":"地区","value":[{"n":"全部","v":""},{"n":"大陆","v":"&area_id=2"},{"n":"香港","v":"&area_id=5"},{"n":"台湾","v":"&area_id=4"},{"n":"韩国","v":"&area_id=17"},{"n":"日本","v":"&area_id=18"},{"n":"欧美","v":"&area_id=6"},{"n":"泰国","v":"&area_id=10"},{"n":"印度","v":"&area_id=14"},{"n":"其他","v":"&area_id=3"}]},{"key":"类型","name":"类型","value":[{"n":"全部","v":""},{"n":"伦理","v":"/c/33"},{"n":"动作","v":"/c/5"},{"n":"喜剧","v":"/c/6"},{"n":"爱情","v":"/c/7"},{"n":"科幻","v":"/c/8"},{"n":"恐怖","v":"/c/9"},{"n":"犯罪","v":"/c/10"},{"n":"战争","v":"/c/11"},{"n":"动漫","v":"/c/12"},{"n":"剧情","v":"/c/13"},{"n":"纪录","v":"/c/30"},{"n":"悬疑","v":"/c/34"},{"n":"动画","v":"/c/35"},{"n":"其他","v":"/c/48"},{"n":"解说","v":"/c/32"}]},{"key":"年份","name":"年份","value":[{"n":"全部","v":""},{"n":"2024","v":"&year=2024"},{"n":"2023","v":"&year=2023"},{"n":"2022","v":"&year=2022"},{"n":"2021","v":"&year=2021"},{"n":"2020","v":"&year=2020"},{"n":"2019","v":"&year=2019"},{"n":"2018","v":"&year=2018"},{"n":"2017","v":"&year=2017"},{"n":"2016","v":"&year=2016"},{"n":"2015","v":"&year=2015"},{"n":"2014","v":"&year=2014"}]},{"key":"排序","name":"排序","value":[{"n":"熱播","v":""},{"n":"最新","v":"&sort=last"}]}],"2":[{"key":"地区","name":"地区","value":[{"n":"全部","v":""},{"n":"大陆","v":"/c/15"},{"n":"台湾","v":"/c/89"},{"n":"香港","v":"/c/88"},{"n":"日本","v":"/c/90"},{"n":"韩国","v":"/c/91"},{"n":"欧美","v":"/c/18"},{"n":"其他","v":"/c/16"}]},{"key":"年份","name":"年份","value":[{"n":"全部","v":""},{"n":"2024","v":"&year=2024"},{"n":"2023","v":"&year=2023"},{"n":"2022","v":"&year=2022"},{"n":"2021","v":"&year=2021"},{"n":"2020","v":"&year=2020"},{"n":"2019","v":"&year=2019"},{"n":"2018","v":"&year=2018"},{"n":"2017","v":"&year=2017"},{"n":"2016","v":"&year=2016"},{"n":"2015","v":"&year=2015"},{"n":"2014","v":"&year=2014"}]},{"key":"排序","name":"排序","value":[{"n":"熱播","v":""},{"n":"最新","v":"&sort=last"}]}],"3":[{"key":"地区","name":"地区","value":[{"n":"全部","v":""},{"n":"大陆","v":"/c/19"},{"n":"香港","v":"/c/20"},{"n":"台湾","v":"/c/81"},{"n":"日本","v":"/c/83"},{"n":"韩国","v":"/c/82"},{"n":"欧美","v":"/c/22"},{"n":"泰国","v":"/c/92"},{"n":"其他","v":"/c/23"}]},{"key":"年份","name":"年份","value":[{"n":"全部","v":""},{"n":"2024","v":"&year=2024"},{"n":"2023","v":"&year=2023"},{"n":"2022","v":"&year=2022"},{"n":"2021","v":"&year=2021"},{"n":"2020","v":"&year=2020"},{"n":"2019","v":"&year=2019"},{"n":"2018","v":"&year=2018"},{"n":"2017","v":"&year=2017"},{"n":"2016","v":"&year=2016"},{"n":"2015","v":"&year=2015"},{"n":"2014","v":"&year=2014"}]},{"key":"排序","name":"排序","value":[{"n":"熱播","v":""},{"n":"最新","v":"&sort=last"}]}],"4":[{"key":"地区","name":"地区","value":[{"n":"全部","v":""},{"n":"大陆","v":"/c/26"},{"n":"日本","v":"/c/86"},{"n":"韩国","v":"/c/87"},{"n":"欧美","v":"/c/27"},{"n":"其他","v":"/c/28"}]},{"key":"年份","name":"年份","value":[{"n":"全部","v":""},{"n":"2024","v":"&year=2024"},{"n":"2023","v":"&year=2023"},{"n":"2022","v":"&year=2022"},{"n":"2021","v":"&year=2021"},{"n":"2020","v":"&year=2020"},{"n":"2019","v":"&year=2019"},{"n":"2018","v":"&year=2018"},{"n":"2017","v":"&year=2017"},{"n":"2016","v":"&year=2016"},{"n":"2015","v":"&year=2015"},{"n":"2014","v":"&year=2014"}]},{"key":"排序","name":"排序","value":[{"n":"熱播","v":""},{"n":"最新","v":"&sort=last"}]}],"53":[{"key":"类型","name":"类型","value":[{"n":"全部","v":""},{"n":"足球","v":"/c/54"},{"n":"篮球","v":"/c/55"},{"n":"游戏","v":"/c/59"},{"n":"台球","v":"/c/63"},{"n":"网球","v":"/c/64"},{"n":"其他","v":"/c/93"}]},{"key":"年份","name":"年份","value":[{"n":"全部","v":""},{"n":"2024","v":"&year=2024"},{"n":"2023","v":"&year=2023"},{"n":"2022","v":"&year=2022"},{"n":"2021","v":"&year=2021"},{"n":"2020","v":"&year=2020"},{"n":"2019","v":"&year=2019"},{"n":"2018","v":"&year=2018"},{"n":"2017","v":"&year=2017"},{"n":"2016","v":"&year=2016"},{"n":"2015","v":"&year=2015"},{"n":"2014","v":"&year=2014"}]},{"key":"排序","name":"排序","value":[{"n":"熱播","v":""},{"n":"最新","v":"&sort=last"}]}],"66":[{"key":"类型","name":"类型","value":[{"n":"全部","v":""},{"n":"爽剧","v":"/c/67"},{"n":"言情","v":"/c/68"},{"n":"穿越","v":"/c/70"},{"n":"悬疑","v":"/c/71"},{"n":"古装","v":"/c/73"},{"n":"都市","v":"/c/80"},{"n":"甜宠","v":"/c/84"},{"n":"虐恋","v":"/c/85"},{"n":"其他","v":"/c/74"}]},{"key":"年份","name":"年份","value":[{"n":"全部","v":""},{"n":"2024","v":"&year=2024"},{"n":"2023","v":"&year=2023"},{"n":"2022","v":"&year=2022"},{"n":"2021","v":"&year=2021"},{"n":"2020","v":"&year=2020"},{"n":"2019","v":"&year=2019"},{"n":"2018","v":"&year=2018"},{"n":"2017","v":"&year=2017"},{"n":"2016","v":"&year=2016"},{"n":"2015","v":"&year=2015"},{"n":"2014","v":"&year=2014"}]},{"key":"排序","name":"排序","value":[{"n":"熱播","v":""},{"n":"最新","v":"&sort=last"}]}]},
    filter_url: '{% if fyclass !="1" %}{{fl.地区}}?page=fypage{% else %}{{fl.类型}}?page=fypage{{fl.地区|safe}}{% endif %}{{fl.年份|safe}}{{fl.排序|safe}}',
    filter_def: {},
    headers: {
        'User-Agent': 'MOBILE_UA',
    },
    timeout: 5000,
    class_parse: '.nav-tabs&&a;a&&Text;a&&href;(\\d+)',
    cate_exclude: '',
    play_parse: true,
    lazy: $js.toString(() => {
        let html = request(input);
        let sdata = pdfh(html, '.container-fluid&&script&&Html');
        // log(sdata);
        let json = JSON.parse(sdata);
        if (json.contentUrl) {
            input = {parse: 0, url: json.contentUrl, js: ''};
        }
    }),
    double: false,
    推荐: '*',
    //α大佬方案去除推荐页广告
    一级: '#videos&&.card:not(:has(.badge-success:contains(广告)));a:eq(-1)&&Text;img&&src;.badge-success&&Text;a:eq(-1)&&href',
    二级: $js.toString(() => {
        let html = request(input);
        let data = html.split('node:')[1].split('},')[0] + '}';
        //log(data);
        data = data.trim();
        let json = JSON.parse(data);
        //log(json);
        VOD = {};
        VOD.vod_name = json.title;
        VOD.type_name = json.type;
        VOD.vod_id = input;
        VOD.vod_pic = urljoin(input, json.thumbnail);
        VOD.vod_year = json.year;
        VOD.vod_area = json._area;
        VOD.vod_remarks = json.note;
        VOD.vod_content = json.description;
        VOD.vod_director = json.director;
        VOD.vod_actor = json.actors;
        let v_tabs = pdfa(html, '.nav-tabs&&li');
        let v_tab_urls = v_tabs.map(it => pd(it, 'a&&href', input));
        v_tabs = v_tabs.map(it => pdfh(it, 'a&&title'));
        log(v_tab_urls);
        VOD.vod_play_from = v_tabs.join('$$$');
        let lists = [];
        let list1 = pdfa(html, '#w1&&a').map(it => pdfh(it, 'a&&Text') + '$' + pd(it, 'a&&href', input));
        let list2 = pdfa(html, '.mb-2.fullwidth&&a').map(it => pdfh(it, 'a&&Text') + '$' + pd(it, 'a&&href', input));
        log(list1);
        //lists.push(list1);
        if (list2.length > 0) {
            let reqUrls = v_tab_urls.map(it => {
                return {
                    url: it,
                    options: {
                        timeout: 5000,
                        headers: rule.headers
                    }
                }
            });
            let htmls = batchFetch(reqUrls);
            htmls.forEach((ht) => {
                if (ht) {
                    let list0 = pdfa(ht, '.mb-2.fullwidth&&a').map(it => pdfh(it, 'a&&Text') + '$' + pd(it, 'a&&href', input));
                    lists.push(list0);
                    log(list0);
                } else {
                    lists.push([]);
                }
            });
          var playUrls = lists.map(it => it.join('#'));
        }else{
          lists.push(list1);
          var playUrls = lists.map(it => it.join('$$$'));
        }
        VOD.vod_play_url = playUrls.join('$$$');
    }),
    搜索: '*',
}